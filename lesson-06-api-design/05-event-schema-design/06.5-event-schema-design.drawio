<mxfile host="app.diagrams.net" modified="2024-01-15T10:00:00.000Z" agent="Claude" version="22.1.0">
  <diagram name="Event Schema Design" id="event-schema">
    <mxGraphModel dx="1400" dy="900" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1100" math="0" shadow="1">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="Event Schema Design" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="500" y="20" width="400" height="40" as="geometry" />
        </mxCell>

        <!-- Event Structure Overview -->
        <mxCell id="struct-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;shadow=0;" vertex="1" parent="1">
          <mxGeometry x="80" y="80" width="500" height="380" as="geometry" />
        </mxCell>
        <mxCell id="struct-title" value="EVENT STRUCTURE" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=14;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="100" y="90" width="200" height="25" as="geometry" />
        </mxCell>

        <!-- Event Envelope -->
        <mxCell id="envelope" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#6c8ebf;strokeWidth=2;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="100" y="125" width="460" height="320" as="geometry" />
        </mxCell>
        <mxCell id="envelope-label" value="Event Envelope" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=11;fontStyle=1;fontColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="110" y="130" width="100" height="20" as="geometry" />
        </mxCell>

        <!-- Header Section -->
        <mxCell id="header-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="120" y="155" width="420" height="75" as="geometry" />
        </mxCell>
        <mxCell id="header-label" value="HEADER (Routing &amp; Identity)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;fontStyle=1;fontColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="130" y="160" width="180" height="15" as="geometry" />
        </mxCell>
        <mxCell id="header-content" value="event_id: &quot;evt-abc123-def456&quot;     (UUID - unique identifier)&#xa;event_type: &quot;policy.created&quot;       (domain.action format)&#xa;source: &quot;policy-service&quot;           (originating service)&#xa;correlation_id: &quot;req-xyz789&quot;       (trace across services)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=9;fontFamily=Courier New;" vertex="1" parent="1">
          <mxGeometry x="130" y="178" width="400" height="50" as="geometry" />
        </mxCell>

        <!-- Metadata Section -->
        <mxCell id="meta-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="120" y="240" width="420" height="75" as="geometry" />
        </mxCell>
        <mxCell id="meta-label" value="METADATA (Context &amp; Timing)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;fontStyle=1;fontColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="130" y="245" width="180" height="15" as="geometry" />
        </mxCell>
        <mxCell id="meta-content" value="timestamp: &quot;2024-01-15T10:30:00.000Z&quot;   (ISO 8601 UTC)&#xa;version: &quot;1.2.0&quot;                        (schema version)&#xa;tenant_id: &quot;tenant-001&quot;                 (multi-tenancy)&#xa;actor: { type: &quot;user&quot;, id: &quot;user-123&quot; } (who triggered)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=9;fontFamily=Courier New;" vertex="1" parent="1">
          <mxGeometry x="130" y="263" width="400" height="50" as="geometry" />
        </mxCell>

        <!-- Payload Section -->
        <mxCell id="payload-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="120" y="325" width="420" height="105" as="geometry" />
        </mxCell>
        <mxCell id="payload-label" value="PAYLOAD (Business Data)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10;fontStyle=1;fontColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="130" y="330" width="180" height="15" as="geometry" />
        </mxCell>
        <mxCell id="payload-content" value="data: {&#xa;  policy_id: &quot;POL-2024-001234&quot;,&#xa;  policy_number: &quot;INS/MOT/2024/001234&quot;,&#xa;  product_code: &quot;MOTOR_COMP&quot;,&#xa;  premium: { amount: 15000.00, currency: &quot;THB&quot; },&#xa;  effective_date: &quot;2024-02-01&quot;,&#xa;  customer_id: &quot;CUST-789&quot;&#xa;}" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;fontSize=9;fontFamily=Courier New;" vertex="1" parent="1">
          <mxGeometry x="130" y="348" width="400" height="80" as="geometry" />
        </mxCell>

        <!-- CloudEvents Section -->
        <mxCell id="cloud-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;shadow=0;" vertex="1" parent="1">
          <mxGeometry x="600" y="80" width="440" height="380" as="geometry" />
        </mxCell>
        <mxCell id="cloud-title" value="CLOUDEVENTS FORMAT (Industry Standard)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=14;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="620" y="90" width="350" height="25" as="geometry" />
        </mxCell>

        <!-- CloudEvents Example -->
        <mxCell id="cloud-example" value="{&#xa;  &quot;specversion&quot;: &quot;1.0&quot;,&#xa;  &quot;type&quot;: &quot;com.insurance.policy.created&quot;,&#xa;  &quot;source&quot;: &quot;/services/policy-service&quot;,&#xa;  &quot;id&quot;: &quot;evt-abc123-def456-ghi789&quot;,&#xa;  &quot;time&quot;: &quot;2024-01-15T10:30:00.000Z&quot;,&#xa;  &quot;datacontenttype&quot;: &quot;application/json&quot;,&#xa;  &quot;subject&quot;: &quot;POL-2024-001234&quot;,&#xa;  &#xa;  // Extension attributes&#xa;  &quot;correlationid&quot;: &quot;req-xyz789&quot;,&#xa;  &quot;tenantid&quot;: &quot;tenant-001&quot;,&#xa;  &quot;schemaversion&quot;: &quot;1.2.0&quot;,&#xa;  &#xa;  // Business data&#xa;  &quot;data&quot;: {&#xa;    &quot;policy_id&quot;: &quot;POL-2024-001234&quot;,&#xa;    &quot;policy_number&quot;: &quot;INS/MOT/2024/001234&quot;,&#xa;    &quot;product_code&quot;: &quot;MOTOR_COMP&quot;,&#xa;    &quot;premium&quot;: 15000.00,&#xa;    &quot;currency&quot;: &quot;THB&quot;,&#xa;    &quot;customer_id&quot;: &quot;CUST-789&quot;&#xa;  }&#xa;}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#CCCCCC;fontSize=9;align=left;spacingLeft=8;verticalAlign=top;spacingTop=8;fontFamily=Courier New;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="620" y="125" width="300" height="320" as="geometry" />
        </mxCell>

        <!-- CloudEvents Required Fields -->
        <mxCell id="cloud-required" value="Required Fields:&#xa;• specversion&#xa;• type&#xa;• source&#xa;• id&#xa;&#xa;Optional:&#xa;• time&#xa;• datacontenttype&#xa;• subject&#xa;• data" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=9;align=left;spacingLeft=8;verticalAlign=top;spacingTop=5;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="940" y="125" width="90" height="180" as="geometry" />
        </mxCell>

        <!-- Versioning Strategy Section -->
        <mxCell id="version-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;shadow=0;" vertex="1" parent="1">
          <mxGeometry x="80" y="480" width="500" height="280" as="geometry" />
        </mxCell>
        <mxCell id="version-title" value="VERSIONING STRATEGY" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=14;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="100" y="490" width="200" height="25" as="geometry" />
        </mxCell>

        <!-- Version Timeline -->
        <mxCell id="v1" value="v1.0.0&#xa;Initial" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=10;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="100" y="530" width="80" height="45" as="geometry" />
        </mxCell>
        <mxCell id="v2" value="v1.1.0&#xa;Add field" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=10;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="220" y="530" width="80" height="45" as="geometry" />
        </mxCell>
        <mxCell id="v3" value="v1.2.0&#xa;Optional" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=10;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="340" y="530" width="80" height="45" as="geometry" />
        </mxCell>
        <mxCell id="v4" value="v2.0.0&#xa;Breaking" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;fontSize=10;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="460" y="530" width="80" height="45" as="geometry" />
        </mxCell>

        <!-- Version Arrows -->
        <mxCell id="va1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#82b366;strokeWidth=2;endArrow=block;endFill=1;flowAnimation=1;" edge="1" parent="1" source="v1" target="v2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="va2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#82b366;strokeWidth=2;endArrow=block;endFill=1;flowAnimation=1;" edge="1" parent="1" source="v2" target="v3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="va3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#b85450;strokeWidth=2;endArrow=block;endFill=1;flowAnimation=1;" edge="1" parent="1" source="v3" target="v4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Version Rules -->
        <mxCell id="version-rules" value="Semantic Versioning Rules:&#xa;&#xa;MAJOR (x.0.0) - Breaking changes&#xa;  • Removing fields&#xa;  • Changing field types&#xa;  • Renaming fields&#xa;&#xa;MINOR (0.x.0) - Backward compatible&#xa;  • Adding optional fields&#xa;  • Adding new event types&#xa;&#xa;PATCH (0.0.x) - Bug fixes&#xa;  • Documentation updates&#xa;  • Validation rule tweaks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#CCCCCC;fontSize=9;align=left;spacingLeft=8;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="100" y="595" width="200" height="155" as="geometry" />
        </mxCell>

        <!-- Compatibility -->
        <mxCell id="compat" value="Backward Compatibility:&#xa;&#xa;• New fields must be optional&#xa;• Never remove required fields&#xa;• Use default values&#xa;• Deprecate before removing&#xa;• Support N-1 versions&#xa;• Document breaking changes" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#CCCCCC;fontSize=9;align=left;spacingLeft=8;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="320" y="595" width="180" height="155" as="geometry" />
        </mxCell>

        <!-- Event Types Section -->
        <mxCell id="types-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;shadow=0;" vertex="1" parent="1">
          <mxGeometry x="600" y="480" width="440" height="280" as="geometry" />
        </mxCell>
        <mxCell id="types-title" value="INSURANCE EVENT TYPES" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=14;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="620" y="490" width="250" height="25" as="geometry" />
        </mxCell>

        <!-- Event Categories -->
        <mxCell id="cat-policy" value="Policy Domain:&#xa;• policy.quoted&#xa;• policy.created&#xa;• policy.endorsed&#xa;• policy.renewed&#xa;• policy.cancelled&#xa;• policy.expired" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=9;align=left;spacingLeft=8;verticalAlign=top;spacingTop=5;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="620" y="525" width="130" height="110" as="geometry" />
        </mxCell>

        <mxCell id="cat-claims" value="Claims Domain:&#xa;• claim.filed&#xa;• claim.assigned&#xa;• claim.assessed&#xa;• claim.approved&#xa;• claim.rejected&#xa;• claim.settled" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=9;align=left;spacingLeft=8;verticalAlign=top;spacingTop=5;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="760" y="525" width="130" height="110" as="geometry" />
        </mxCell>

        <mxCell id="cat-payment" value="Payment Domain:&#xa;• payment.initiated&#xa;• payment.completed&#xa;• payment.failed&#xa;• payment.refunded&#xa;• invoice.created&#xa;• invoice.paid" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=9;align=left;spacingLeft=8;verticalAlign=top;spacingTop=5;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="900" y="525" width="130" height="110" as="geometry" />
        </mxCell>

        <!-- Naming Convention -->
        <mxCell id="naming" value="Naming Convention:&#xa;&#xa;Format: {domain}.{entity}.{action}&#xa;&#xa;Examples:&#xa;  insurance.policy.created&#xa;  insurance.claim.status_changed&#xa;  insurance.customer.kyc_verified&#xa;&#xa;Rules:&#xa;• Use lowercase&#xa;• Use dots as separators&#xa;• Past tense for completed actions&#xa;• Be specific and descriptive" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#CCCCCC;fontSize=9;align=left;spacingLeft=8;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="620" y="645" width="410" height="105" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
